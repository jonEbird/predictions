# Only load env vars if not in Claude Code context
if [[ -z "$CLAUDECODE" ]] && [[ -z "$APPLE_GEMINI_CLI" ]]; then
  # Use Node version from .node-version file
  if [[ -f .node-version ]]; then
    NODE_VERSION=$(cat .node-version)
    NODE_PATH="/opt/homebrew/opt/node@${NODE_VERSION}/bin"
    if [[ -d "$NODE_PATH" ]]; then
      PATH_add "$NODE_PATH"
      echo "Using Node ${NODE_VERSION} from ${NODE_PATH}"
    else
      echo "Warning: Node ${NODE_VERSION} not found at ${NODE_PATH}"
      echo "Install with: brew install node@${NODE_VERSION}"
    fi
  fi

  # Add node_modules/.bin to PATH
  PATH_add node_modules/.bin

  # Optional: Load environment variables from .env file
  dotenv_if_exists

  # Optional: Set NODE_ENV for development
  export NODE_ENV=development
fi

# Source local overrides if they exist (not committed to repo)
[[ -f .envrc.local ]] && source_env .envrc.local
